!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o="message",i=n.ERR_CONNECTION_DESTROYED="ConnectionDestroyed",a=n.ERR_CONNECTION_TIMEOUT="ConnectionTimeout",c=n.ERR_NOT_IN_IFRAME="NotInIframe",u={"http:":"80","https:":"443"},d=/^(https?:)?\/\/([^\/:]+)(:(\d+))?/,l={ERR_CONNECTION_DESTROYED:i,ERR_CONNECTION_TIMEOUT:a,ERR_NOT_IN_IFRAME:c,Promise:function(){try{return window?window.Promise:null}catch(e){return null}}(),debug:!1},s=(r=0,function(){return++r}),f=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];var r;l.debug&&(r=console).log.apply(r,["[Penpal]"].concat(n))},p=function(e){var n=[];return e((function(){n.forEach((function(e){e()}))})),{then:function(e){n.push(e)}}},m=function(e){return{name:e.name,message:e.message,stack:e.stack}},v=function(e){var n=new Error;return Object.keys(e).forEach((function(t){return n[t]=e[t]})),n},h=function(e,n,t,r){var a=n.localName,c=n.local,u=n.remote,d=n.remoteOrigin,p=!1;f(a+": Connecting call sender");r.then((function(){p=!0})),t.reduce((function(e,n){return e[n]=function(e){return function(){for(var n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];if(f(a+": Sending "+e+"() call"),p){var m=new Error("Unable to send "+e+"() call due to destroyed connection");throw m.code=i,m}return new l.Promise((function(n,r){var i=s();c.addEventListener(o,(function t(l){if(l.source===u&&l.origin===d&&"reply"===l.data.penpal&&l.data.id===i){f(a+": Received "+e+"() reply"),c.removeEventListener(o,t);var s=l.data.returnValue;l.data.returnValueIsError&&(s=v(s)),("fulfilled"===l.data.resolution?n:r)(s)}})),u.postMessage({penpal:"call",id:i,methodName:e,args:t},d)}))}}(n),e}),e)},y=function(e,n,t){var r=e.localName,i=e.local,a=e.remote,c=e.remoteOrigin,u=!1;f(r+": Connecting call receiver");var d=function(e){if(e.source===a&&e.origin===c&&"call"===e.data.penpal){var t=e.data,o=t.methodName,i=t.args,d=t.id;if(f(r+": Received "+o+"() call"),o in n){var s=function(e){return function(n){if(f(r+": Sending "+o+"() reply"),u)f(r+": Unable to send "+o+"() reply due to destroyed connection");else{var t={penpal:"reply",id:d,resolution:e,returnValue:n};"rejected"===e&&n instanceof Error&&(t.returnValue=m(n),t.returnValueIsError=!0);try{a.postMessage(t,c)}catch(e){throw"DataCloneError"===e.name&&a.postMessage({penpal:"reply",id:d,resolution:"rejected",returnValue:m(e),returnValueIsError:!0},c),e}}}};new l.Promise((function(e){return e(n[o].apply(n,i))})).then(s("fulfilled"),s("rejected"))}}};i.addEventListener(o,d),t.then((function(){u=!0,i.removeEventListener(o,d)}))};l.connectToChild=function(e){var n=e.url,t=e.appendTo,r=e.methods,c=void 0===r?{}:r,s=e.timeout,m=void 0,v=new p((function(e){return m=e})),E=window,g=document.createElement("iframe");(t||document.body).appendChild(g),v.then((function(){g.parentNode&&g.parentNode.removeChild(g)}));var w=g.contentWindow||g.contentDocument.parentWindow,O=function(e){var n=document.location,t=d.exec(e),r=void 0,o=void 0,i=void 0;return t?(r=t[1]?t[1]:n.protocol,o=t[2],i=t[4]):(r=n.protocol,o=n.hostname,i=n.port),r+"//"+o+(i&&i!==u[r]?":"+i:"")}(n);return{promise:new l.Promise((function(e,t){var r;void 0!==s&&(r=setTimeout((function(){var e=new Error("Connection to child timed out after "+s+"ms");e.code=a,t(e),m()}),s));var u={},d=void 0,l=function(n){if(n.source===w&&n.origin===O&&"handshake"===n.data.penpal){f("Parent: Received handshake, sending reply"),n.source.postMessage({penpal:"handshake-reply",methodNames:Object.keys(c)},n.origin);var t={localName:"Parent",local:E,remote:w,remoteOrigin:n.origin};y(t,c,v),d&&d.forEach((function(e){delete u[e]})),d=n.data.methodNames,h(u,t,d,v),clearTimeout(r),e(u)}};E.addEventListener(o,l),v.then((function(){E.removeEventListener(o,l);var e=new Error("Connection destroyed");e.code=i,t(e)})),f("Parent: Loading iframe"),g.src=n})),iframe:g,destroy:m}},l.connectToParent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.parentOrigin,t=void 0===n?"*":n,r=e.methods,u=void 0===r?{}:r,d=e.timeout;if(window===window.top){var s=new Error("connectToParent() must be called within an iframe");throw s.code=c,s}var m=void 0,v=new p((function(e){return m=e})),E=window,g=E.parent,w=new l.Promise((function(e,n){var r;void 0!==d&&(r=setTimeout((function(){var e=new Error("Connection to parent timed out after "+d+"ms");e.code=a,n(e),m()}),d));var c=function n(i){if(("*"===t||t===i.origin)&&i.source===g&&"handshake-reply"===i.data.penpal){f("Child: Received handshake reply"),E.removeEventListener(o,n);var a={localName:"Child",local:E,remote:g,remoteOrigin:i.origin},c={};y(a,u,v),h(c,a,i.data.methodNames,v),clearTimeout(r),e(c)}};E.addEventListener(o,c),v.then((function(){E.removeEventListener(o,c);var e=new Error("Connection destroyed");e.code=i,n(e)})),f("Child: Sending handshake"),g.postMessage({penpal:"handshake",methodNames:Object.keys(u)},t)}));return{promise:w,destroy:m}},n.default=l},function(e,n,t){"use strict";t.r(n),function(e){var n,r,o=t(0);n=window,r=function(){return{connect(e={}){return this._connection=Object(o.connectToParent)({methods:e}),this._connection.promise.then(e=>{this._parent=e,Object.keys(e).forEach(e=>{this[e]=n=>(console.assert(this._parent,"StreamBIM parent frame not found"),this._parent[e](n))})})}}},e.exports?e.exports=r():"function"==typeof define&&t(3)?define("StreamBIM",r):n.StreamBIM=r()}.call(this,t(2)(e))},function(e,n){e.exports=function(e){if(!e.webpackPolyfill){var n=Object.create(e);n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),Object.defineProperty(n,"exports",{enumerable:!0}),n.webpackPolyfill=1}return n}},function(e,n){(function(n){e.exports=n}).call(this,{})}]);
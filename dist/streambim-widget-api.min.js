!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o=n.ERR_CONNECTION_DESTROYED="ConnectionDestroyed",a=n.ERR_CONNECTION_TIMEOUT="ConnectionTimeout",i=n.ERR_NOT_IN_IFRAME="NotInIframe",c={"http:":"80","https:":"443"},u=/^(https?:)?\/\/([^\/:]+)(:(\d+))?/,d={ERR_CONNECTION_DESTROYED:o,ERR_CONNECTION_TIMEOUT:a,ERR_NOT_IN_IFRAME:i,Promise:function(){try{return window?window.Promise:null}catch(e){return null}}(),debug:!1},s=(r=0,function(){return++r}),l=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];var r;d.debug&&(r=console).log.apply(r,["[Penpal]"].concat(n))},f=function(e){var n=[];return e(function(){n.forEach(function(e){e()})}),{then:function(e){n.push(e)}}},m=function(e){return{name:e.name,message:e.message,stack:e.stack}},p=function(e,n,t,r){var a=n.localName,i=n.local,c=n.remote,u=n.remoteOrigin,f=!1;l(a+": Connecting call sender");var m=function(e){return function(){for(var n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];if(l(a+": Sending "+e+"() call"),f){var m=new Error("Unable to send "+e+"() call due to destroyed connection");throw m.code=o,m}return new d.Promise(function(n,r){var o=s();i.addEventListener("message",function t(d){if(d.source===c&&d.origin===u&&"reply"===d.data.penpal&&d.data.id===o){l(a+": Received "+e+"() reply"),i.removeEventListener("message",t);var s=d.data.returnValue;d.data.returnValueIsError&&(f=s,m=new Error,Object.keys(f).forEach(function(e){return m[e]=f[e]}),s=m),("fulfilled"===d.data.resolution?n:r)(s)}var f,m}),c.postMessage({penpal:"call",id:o,methodName:e,args:t},u)})}};r.then(function(){f=!0}),t.reduce(function(e,n){return e[n]=m(n),e},e)},v=function(e,n,t){var r=e.localName,o=e.local,a=e.remote,i=e.remoteOrigin,c=!1;l(r+": Connecting call receiver");var u=function(e){if(e.source===a&&e.origin===i&&"call"===e.data.penpal){var t=e.data,o=t.methodName,u=t.args,s=t.id;if(l(r+": Received "+o+"() call"),o in n){var f=function(e){return function(n){if(l(r+": Sending "+o+"() reply"),c)l(r+": Unable to send "+o+"() reply due to destroyed connection");else{var t={penpal:"reply",id:s,resolution:e,returnValue:n};"rejected"===e&&n instanceof Error&&(t.returnValue=m(n),t.returnValueIsError=!0);try{a.postMessage(t,i)}catch(e){throw"DataCloneError"===e.name&&a.postMessage({penpal:"reply",id:s,resolution:"rejected",returnValue:m(e),returnValueIsError:!0},i),e}}}};new d.Promise(function(e){return e(n[o].apply(n,u))}).then(f("fulfilled"),f("rejected"))}}};o.addEventListener("message",u),t.then(function(){c=!0,o.removeEventListener("message",u)})};d.connectToChild=function(e){var n=e.url,t=e.appendTo,r=e.methods,i=void 0===r?{}:r,s=e.timeout,m=void 0,h=new f(function(e){return m=e}),g=window,y=document.createElement("iframe");(t||document.body).appendChild(y),h.then(function(){y.parentNode&&y.parentNode.removeChild(y)});var E=y.contentWindow||y.contentDocument.parentWindow,w=function(e){var n=document.location,t=u.exec(e),r=void 0,o=void 0,a=void 0;return t?(r=t[1]?t[1]:n.protocol,o=t[2],a=t[4]):(r=n.protocol,o=n.hostname,a=n.port),r+"//"+o+(a&&a!==c[r]?":"+a:"")}(n);return{promise:new d.Promise(function(e,t){var r;void 0!==s&&(r=setTimeout(function(){var e=new Error("Connection to child timed out after "+s+"ms");e.code=a,t(e),m()},s));var c={},u=void 0,d=function(n){if(n.source===E&&n.origin===w&&"handshake"===n.data.penpal){l("Parent: Received handshake, sending reply"),n.source.postMessage({penpal:"handshake-reply",methodNames:Object.keys(i)},n.origin);var t={localName:"Parent",local:g,remote:E,remoteOrigin:n.origin};v(t,i,h),u&&u.forEach(function(e){delete c[e]}),u=n.data.methodNames,p(c,t,u,h),clearTimeout(r),e(c)}};g.addEventListener("message",d),h.then(function(){g.removeEventListener("message",d);var e=new Error("Connection destroyed");e.code=o,t(e)}),l("Parent: Loading iframe"),y.src=n}),iframe:y,destroy:m}},d.connectToParent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.parentOrigin,t=void 0===n?"*":n,r=e.methods,c=void 0===r?{}:r,u=e.timeout;if(window===window.top){var s=new Error("connectToParent() must be called within an iframe");throw s.code=i,s}var m=void 0,h=new f(function(e){return m=e}),g=window,y=g.parent;return{promise:new d.Promise(function(e,n){var r;void 0!==u&&(r=setTimeout(function(){var e=new Error("Connection to parent timed out after "+u+"ms");e.code=a,n(e),m()},u));var i=function n(o){if(("*"===t||t===o.origin)&&o.source===y&&"handshake-reply"===o.data.penpal){l("Child: Received handshake reply"),g.removeEventListener("message",n);var a={localName:"Child",local:g,remote:y,remoteOrigin:o.origin},i={};v(a,c,h),p(i,a,o.data.methodNames,h),clearTimeout(r),e(i)}};g.addEventListener("message",i),h.then(function(){g.removeEventListener("message",i);var e=new Error("Connection destroyed");e.code=o,n(e)}),l("Child: Sending handshake"),y.postMessage({penpal:"handshake",methodNames:Object.keys(c)},t)}),destroy:m}},n.default=d},function(e,n,t){"use strict";t.r(n),function(e){var n,r,o=t(0),a=t.n(o);n=window,r=function(){return{connect(e={}){return this._connection=a.a.connectToParent({methods:e}),this._connection.promise.then(e=>{this._parent=e,Object.keys(e).forEach(e=>{this[e]=(n=>(console.assert(this._parent,"StreamBIM parent frame not found"),this._parent[e](n)))})})}}},e.exports?e.exports=r():"function"==typeof define&&t(3)?define("StreamBIM",r):n.StreamBIM=r()}.call(this,t(2)(e))},function(e,n){e.exports=function(e){if(!e.webpackPolyfill){var n=Object.create(e);n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),Object.defineProperty(n,"exports",{enumerable:!0}),n.webpackPolyfill=1}return n}},function(e,n){(function(n){e.exports=n}).call(this,{})}]);